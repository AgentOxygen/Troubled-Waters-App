<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Troubled Waters | California Hydroclimate Model Agreement</title>
	<link href='https://api.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.css' rel='stylesheet' />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
	<style>
		.metric_grid {
			border: 1px solid #fff;
			overflow: hidden;
			transition: all .3s linear;
		}
		.metric:hover img {
			transform: scale(1.1);
			transition: all .2s linear;
		}
		.metric-row-margin { 
			margin-top: 1.0em; 
		}
		.regions_dropdown {
			height: 20vh;
			overflow: auto;
		}
	</style>
  </head>
  <body>
	
	<div class="metric_grid text-center" id="metric_selection">
		<div class="row align-items-start metric-row-margin">
			<div class="col">
				<a class="metric" href="#" onclick="switchToMapAndControls('')">
					<img class="img-thumbnail" src="images/frac_extreme.png" alt="Δ Fraction of Yearly Precipitation on Extreme Days">
				</a>
			</div>
			<div class="col">
				<a class="metric" href="#" onclick="switchToMapAndControls('')">
					<img class="img-thumbnail" src="images/max_threeday_precip.png" alt="Δ Maximum Three-day Precipitation">
				</a>
			</div>
			<div class="col">
				<a class="metric" href="#" onclick="switchToMapAndControls('')">
					<img class="img-thumbnail" src="images/nov_mar_percent.png" alt="Δ Fraction of Yearly Precipitation between November-March">
				</a>
			</div>
		</div>
		<div class="row align-items-center metric-row-margin">
			<div class="col">
				<a class="metric" href="#" onclick="switchToMapAndControls('')">
					<img class="img-thumbnail" src="images/rainfall_ratio.png" alt="Δ Ratio of Yearly Precipitation as Rain vs Snow">
				</a>
			</div>
			<div class="col">
				<a class="metric" href="#" onclick="switchToMapAndControls('')">
					<img class="img-thumbnail" src="images/num_ros_events.png" alt="Δ Number of Rain-On-Snow Days">
				</a>
			</div>
			<div class="col">
				<a class="metric" href="#" onclick="switchToMapAndControls('')">
					<img class="img-thumbnail" src="images/norm_rain_on_snow.png" alt="Δ Normalized Number of Rain-On-Snow Days">
				</a>
			</div>
		</div>
		<div class="row align-items-end metric-row-margin">
			<div class="col">
				<a class="metric" href="#" onclick="switchToMapAndControls('')">
					<img class="img-thumbnail" src="images/SWE_total.png" alt="Δ Cumulative Snow Water Equivalent">
				</a>
			</div>
			<div class="col">
				<a class="metric" href="#" onclick="switchToMapAndControls('')">
					<img class="img-thumbnail" src="images/et.png" alt="Δ Evapotranspiration">
				</a>
			</div>
		</div>
	</div>
	
	<button id="back_to_metric_sel_btn" type="button" class="btn btn-primary" onclick="switchToMetricSelection()" style="display:none">←Back to Metric Selection</button>
	
	<div class="container" style="display:none" id="map_and_controls">
		<div class="row">
			<div class="col">
				<!-- Mapbox tag !-->
				<div id='map' style='width: 40vw; height: 60vh;'></div>
			</div>
			<div class="col">
				<div class="card p-3 m-2">
					<div class="row m-1" id="toolbar_row">
						<div class="btn-group btn-group-toggle" data-toggle="buttons">
							<div class="btn-group me-2" role="group" aria-label="Shapefile Buttons">
								<div class="btn-group">
									<button id="shp_gwbasins" type="button" class="btn btn-outline-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<span class="sr-only">Groundwater Basins</span>
									</button>
									<div class="dropdown-menu" id="drpdwn_gw">
										<!-- Create python function to populate these dynamically !-->
										<div class="regions_dropdown">
											<a id="reg_basin1" onclick="changeRegion('reg_basin1', 'shp_gwbasins', 'Groundwater Basins', 'Basin 1')" class="dropdown-item" href="#">Basin 1</a>
											<a id="reg_basin2" onclick="changeRegion('reg_basin2', 'shp_gwbasins', 'Groundwater Basins', 'Basin 2')" class="dropdown-item" href="#">Basin 2</a>
											<a id="reg_basin3" onclick="changeRegion('reg_basin3', 'shp_gwbasins', 'Groundwater Basins', 'Basin 3')" class="dropdown-item" href="#">Basin 3</a>
										</div>
										<div class="dropdown-divider"></div>
										<a class="dropdown-item" href="#">All Basins</a>
										<!-- End of python function content !-->
									</div>
								</div>
								<div class="btn-group">
									<button type="button" class="btn btn-outline-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<span class="sr-only">Watersheds</span>
									</button>
									<div class="dropdown-menu">
										<a class="dropdown-item" href="#">Watershed 1</a>
										<a class="dropdown-item" href="#">Watershed 2</a>
										<a class="dropdown-item" href="#">Watershed 3</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item" href="#">All Watersheds</a>
									</div>
								</div>
								<div class="btn-group">
									<button type="button" class="btn btn-outline-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<span class="sr-only">Counties</span>
									</button>
									<div class="dropdown-menu">
										<a class="dropdown-item" href="#">County 1</a>
										<a class="dropdown-item" href="#">County 2</a>
										<a class="dropdown-item" href="#">County 3</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item" href="#">All Counties</a>
									</div>
								</div>
								<div class="btn-group">
									<button type="button" class="btn btn-outline-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<span class="sr-only">Places</span>
									</button>
									<div class="dropdown-menu">
										<a class="dropdown-item" href="#">Place 1</a>
										<a class="dropdown-item" href="#">Place 2</a>
										<a class="dropdown-item" href="#">Place 3</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item" href="#">All Places</a>
									</div>
								</div>
							</div>
							<div class="btn-group me-3 btn-group-toggle" data-toggle="buttons">
								<label onclick="switchRCP(85)" class="btn btn-outline-secondary active">
									<input type="radio" style="display:none" autocomplete="off" checked>
									RCP 8.5
								</label>
								<label onclick="switchRCP(45)" class="btn btn-outline-secondary">
									<input type="radio" style="display:none" autocomplete="off">
									RCP 4.5
								</label>
							</div>
						</div>
					</div>
					<div class="row" id="info_row">
						<div class="col">
							<h2>Region Name</h2></br>
							Average metric value</br>
							Standard Deviation of metric value </br>
							Model Agreement Median</br>
							Model Agreement Mode</br>
							Rasterized Image of region with overlayed metric value</br>
							Rasterized Image of region with overlayed agreement</br>
						</div>
						<div class="col">
							<h2>Metric Name</h2></br>
							California Average metric value</br>
							California Standard Deviation metric value</br>
							Historical metric value</br>
							Future metric value</br>
							Rasterized Image of figure from paper</br>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

  
	<!--
	<script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
	<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
	!-->
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

	<script src='https://api.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.js'></script>
	<script type="application/javascript">
		metric = "";
		rcp = 85;
		region = "";
		
		active_btnID = "";
		active_btngrpID = "";
		
		function switchRCP(rcpNumber){
			console.log("Switching to RCP " + rcpNumber.toString());
			rcp = rcpNumber;
		}
		
		function switchShapefile(shapefileName){
			console.log("Switching to shapefile " + shapefileName);
		}
		
		function changeRegion(btnID, btngrpID, shapefileName, regionName){
			switchShapefile(shapefileName);
			console.log("Changing region to " + regionName);
			region = regionName;
			if (active_btnID != ""){
				$("#" + active_btnID).button('toggle');
			}
			if (active_btngrpID != "") {
				$("#" + active_btngrpID).button('toggle');
			}
			active_btnID = btnID;
			active_btngrpID = btngrpID;
			$("#" + btnID).button('toggle');
			$("#" + btngrpID).button('toggle');
			
		}
		
		function switchToMapAndControls(selected_metric){
			metric = selected_metric;
			console.log("Hiding metric selection and moving to map with metric=" + metric);
			document.getElementById("metric_selection").style = "display:none";
			document.getElementById("map_and_controls").style = "display:visible";
			document.getElementById("back_to_metric_sel_btn").style = "display:visible";
		}
		
		function switchToMetricSelection(){
			console.log("Switching back to metric selection")
			document.getElementById("metric_selection").style = "display:visible";
			document.getElementById("map_and_controls").style = "display:none";
			document.getElementById("back_to_metric_sel_btn").style = "display:none";
		}
		
		switchToMapAndControls("test");

		mapboxgl.accessToken = 'pk.eyJ1Ijoib3h5Z2VuMSIsImEiOiJja25jMmh3b28wenFlMnFvaGowN3B6bmc1In0.MKaFBCRkpp4gZWA3hIT-iA';
		const map = new mapboxgl.Map({
			container: 'map', // container ID
			// Choose from Mapbox's core styles, or make your own style with Mapbox Studio
			style: 'mapbox://styles/mapbox/light-v10',
			center: [-122.486052, 37.830348],
			zoom: 4.9
		});
	</script>
  </body>
</html>